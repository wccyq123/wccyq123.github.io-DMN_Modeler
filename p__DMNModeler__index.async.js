(self.webpackChunk=self.webpackChunk||[]).push([[199],{43943:function(le,q,s){var _=s(26068).default,N=s(31759).default,G=s(46241),S=s(11333);function ee(e,t){return console.log(G),new G(e,t)}function R(e,t,n){return ee().fromXML(e,"dmn:Definitions",t,n)}function re(e,t){var n={number:t+1,input:[],inputValues:[],output:[],outputValues:[]};return e.inputEntry&&e.inputEntry.forEach(function(r){var a=r.text;a===""&&(a="-");try{n.inputValues.push(a)}catch(f){throw new Error("Failed to parse input entry: ".concat(a," ").concat(f))}}),e.outputEntry.forEach(function(r){r.text?n.outputValues.push(r.text):(n.output.push(null),n.outputValues.push(null))}),n}function Q(e,t){if(t.hitPolicy!=="FIRST"&&t.hitPolicy!=="UNIQUE"&&t.hitPolicy!=="COLLECT"&&t.hitPolicy!=="RULE ORDER")throw new Error("Unsupported hit policy ".concat(t.hitPolicy));var n={hitPolicy:t.hitPolicy,rules:[],inputExpressions:[],parsedInputExpressions:[],outputNames:[]};return t.rule===void 0?console.log.warn("The decision table for decision '".concat(e,"' contains no rules.")):t.rule.forEach(function(r,a){n.rules.push(re(r,a))}),t.input&&t.input.forEach(function(r){var a;if(r.inputExpression&&r.inputExpression.text)a=r.inputExpression.text;else if(r.inputVariable)a=r.inputVariable;else throw new Error("No input variable or expression set for input '".concat(r.id,"'"));n.inputExpressions.push(a);try{}catch(f){throw new Error("Failed to parse input expression '".concat(a,"': ").concat(f))}}),t.output.forEach(function(r){if(r.name)n.outputNames.push(r.name);else throw new Error('No name set for output "'.concat(r.id,'"'))}),n}function z(e){var t=[];return e.forEach(function(n){if(n.decisionLogic){var r={decisionLogic:Q(n.id,n.decisionLogic),requiredDecisions:[]};n.informationRequirement!==void 0&&n.informationRequirement.forEach(function(a){if(a.requiredDecision!==void 0){var f=a.requiredDecision.href.replace("#","");r.requiredDecisions.push(f)}}),t[n.id]=r}}),t}function ne(e,t){return new Promise(function(n,r){R(e,t,function(a,f){if(a)r(a);else try{var P=z(f.drgElement);n(P)}catch(U){r(U)}})})}function te(e,t){var n=e.split(".");return n.reduce(function(r,a){return r===void 0?void 0:r[a]},t)}function m(e,t,n){var r=e.indexOf(".");if(r<0)t[e]&&Array.isArray(t[e])?t[e].push(n):t[e]=n;else{var a=e.substr(0,r),f=e.substr(r+1);t[a]?m(f,t[a],n):t[a]=m(f,{},n)}return t}function k(e,t){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;if(Array.isArray(t))t.forEach(function(f){return k(e,f,!0)});else for(var r in t)if(t.hasOwnProperty(r)){var a=t[r];Array.isArray(e[r])?Array.isArray(a)?e[r]=e[r].concat(a):a!=null&&e[r].push(a):N(a)==="object"&&a!==null&&!S.isMoment(a)&&!S.isDate(a)&&!S.isDuration(a)?((e[r]===void 0||e[r]===null)&&(e[r]={}),k(e[r],a,n)):n?(e[r]=[],e[r].push(a)):e[r]=a}}function B(e,t,n,r){for(var a=0;a<e.input.length;a+=1)try{var f=t[a].inputVariableName,P=e.input[a].build(_({_inputVariableName:f},r));if(!P(t[a].value))return{matched:!1}}catch(x){throw console.log.error(x),new Error("Failed to evaluate input condition in column ".concat(a+1,": '").concat(e.inputValues[a],"': ").concat(x))}for(var U={},i=0;i<e.output.length;i+=1)if(e.output[i]!==null){var F=e.output[i].build(r);m(n[i],U,F[0])}else m(n[i],U,void 0);return{matched:!0,output:U}}function Z(e,t,n,r){r||(r=[]);var a=t[e];if(a===void 0)throw new Error('No such decision "'.concat(e,'"'));for(var f=0;f<a.requiredDecisions.length;f+=1){var P=a.requiredDecisions[f];if(!r[P]){console.log.debug("Need to evaluate required decision ".concat(P));var U=Z(P,t,n,r);k(n,U),r[P]=!0}}console.log.info('Evaluating decision "'.concat(e,'"...')),console.log.debug("Context: ".concat(JSON.stringify(n)));for(var i=a.decisionLogic,F=[],x=0;x<i.parsedInputExpressions.length;x+=1){var L=i.parsedInputExpressions[x],ae=i.inputExpressions[x];try{var l=L.build(n),W=void 0;L.simpleExpressions&&L.simpleExpressions[0].type==="QualifiedName"&&(W=L.simpleExpressions[0].names.map(function(I){return I.nameChars}).join(".")),F.push({value:l[0],inputVariableName:W})}catch(I){throw new Error("Failed to evaluate input expression ".concat(ae," of decision ").concat(e,": ").concat(I))}}var X=i.hitPolicy==="FIRST"||i.hitPolicy==="UNIQUE"?{}:[];i.outputNames.forEach(function(I){(i.hitPolicy==="FIRST"||i.hitPolicy==="UNIQUE")&&m(I,X,void 0)});for(var $=!1,se=function(){var O=i.rules[V],c;try{c=B(O,F,i.outputNames,n)}catch(o){throw new Error("Failed to evaluate rule ".concat(O.number," of decision ").concat(e,":  ").concat(o))}if(c.matched){if($&&i.hitPolicy==="UNIQUE")throw new Error('Decision "'.concat(e,'" is not unique but hit policy is UNIQUE.'));if($=!0,console.log.info('Result for decision "'.concat(e,'": ').concat(JSON.stringify(c.output)," (rule ").concat(V+1," matched)")),i.hitPolicy==="FIRST"||i.hitPolicy==="UNIQUE"){if(i.outputNames.forEach(function(o){var h=te(o,c.output);(h!==void 0||i.hitPolicy==="FIRST"||i.hitPolicy==="UNIQUE")&&m(o,X,h)}),i.hitPolicy==="FIRST")return 1}else X.push(c.output)}},V=0;V<i.rules.length&&!se();V+=1);return!$&&i.rules.length>0&&console.log.warn('No rule matched for decision "'.concat(e,'".')),X}function p(e,t){if(!e){console.log.debug("undefined");return}t||(t=""),console.log.debug(t+e.type),e.not&&console.log.debug("".concat(t,"  (not)")),e.operator&&console.log.debug("".concat(t,"  ").concat(e.operator));var n="".concat(t,"  ");switch(e.type){case"ArithmeticExpression":{p(e.operand_1,n),p(e.operand_2,n);break}case"FunctionInvocation":{p(e.fnName,n),p(e.params,n);break}case"DateTimeLiteral":e.params.forEach(function(r){return p(r,n)});break;case"Interval":{p(e.startpoint,n),p(e.endpoint,n);break}case"Literal":console.log.debug("".concat(n,'"').concat(e.value,'"'));break;case"Name":console.log.debug("".concat(n,'"').concat(e.nameChars,'"'));break;case"Program":p(e.body,n);break;case"PositionalParameters":e.params.forEach(function(r){return p(r,n)});break;case"QualifiedName":e.names.forEach(function(r){return p(r,n)});break;case"SimpleExpressions":e.simpleExpressions.forEach(function(r){return p(r,n)});break;case"SimplePositiveUnaryTest":p(e.operand,n);break;case"SimpleUnaryTestsNode":e.expr.forEach(function(r){return p(r,n)});break;case"UnaryTestsNode":e.expr.forEach(function(r){return p(r,n)});break;default:console.log.debug("?")}}le.exports={readDmnXml:R,parseDmnXml:ne,parseDecisions:z,evaluateDecision:Z,dumpTree:p}},80657:function(le,q,s){"use strict";s.r(q),s.d(q,{DMNModeler:function(){return V},default:function(){return I}});var _=s(90228),N=s.n(_),G=s(87999),S=s.n(G),ee=s(48305),R=s.n(ee),re=s(85716),Q=s(54397),z=s(13310),ne=s(74623),te=s.n(ne),m=s(93236),k=s(61449),B=s(13763),Z=s(26574),p=s(15558),e=s.n(p),t=s(26068),n=s.n(t),r=s(95949),a=function(c,o){var h=(0,r.ku)(c,o);return h},f=function(c,o){var h=c.inputExpressions.map(function(E){var y=(0,r.ku)(E,o);return y}),g=[];if(c.rules.forEach(function(E){var y=!0;E.inputValues.forEach(function(T,A){T!=="-"&&a(T,o)!==h[A]&&(y=!1)});var M={};y&&c.outputNames.forEach(function(T,A){E.outputValues[A]&&(M[T]=a(E.outputValues[A],o))}),Object.keys(M).length>0&&g.push(n()({},M))}),c.hitPolicy==="UNIQUE"){if(g.length>1)throw"Decision is not unique but hit policy is UNIQUE.";return g[0]}return g},P=function(c){return c.reduce(function(o,h){var g,E;return{required:[].concat(e()(o.required),e()(((g=h.required)===null||g===void 0?void 0:g.split(","))||[])),disabled:[].concat(e()(o.disabled),e()(((E=h.disabled)===null||E===void 0?void 0:E.split(","))||[]))}},{required:[],disabled:[]})},U=s(46241),i=s(43943),F=function(){var O=S()(N()().mark(function c(o){var h,g;return N()().wrap(function(y){for(;;)switch(y.prev=y.next){case 0:return h=new U.default,y.next=3,h.fromXML(o,"dmn:Definitions");case 3:return g=y.sent,y.abrupt("return",(0,i.parseDecisions)(g.rootElement.drgElement));case 5:case"end":return y.stop()}},c)}));return function(o){return O.apply(this,arguments)}}(),x=s(28942),L=s(76653),ae=s(64663),l=s(62086),W=function(c){var o=c.xml,h=(0,m.useState)(""),g=R()(h,2),E=g[0],y=g[1],M=(0,m.useState)(),T=R()(M,2),A=T[0],H=T[1],K=(0,m.useState)(),J=R()(K,2),ie=J[0],Y=J[1],oe=function(v,u){console.log(u),y(v),console.log(v)};(0,m.useEffect)(function(){var b=function(){var v=S()(N()().mark(function u(){var j;return N()().wrap(function(C){for(;;)switch(C.prev=C.next){case 0:return C.next=2,F(o);case 2:j=C.sent,H(j);case 4:case"end":return C.stop()}},u)}));return function(){return v.apply(this,arguments)}}();o&&b()},[o]);var ue=function(){var b=S()(N()().mark(function v(){var u,j,d;return N()().wrap(function(D){for(;;)switch(D.prev=D.next){case 0:return D.prev=0,u=Object.keys(A)[0],j=f(A[u].decisionLogic,JSON.parse(E)),D.next=5,(0,ae.WU)(JSON.stringify(j),{parser:"json",plugins:[x.Z,L.ZP]});case 5:d=D.sent,Y(d),j instanceof Array&&console.log(P(j)),D.next=13;break;case 10:D.prev=10,D.t0=D.catch(0),Y(JSON.stringify({error:D.t0.message||D.t0}));case 13:case"end":return D.stop()}},v,null,[[0,10]])}));return function(){return b.apply(this,arguments)}}();return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)("div",{style:{display:"flex",flexDirection:"row",justifyContent:"space-evenly"},children:[(0,l.jsx)(Z.Z,{title:"Input",children:(0,l.jsx)(B.ZP,{style:{width:"500px"},value:E,height:"200px",extensions:[(0,k.AV)()],onChange:oe})}),(0,l.jsx)(Z.Z,{title:"Result",children:(0,l.jsx)(B.ZP,{value:ie,style:{width:"500px"},height:"200px",extensions:[(0,k.AV)()],editable:!1,readOnly:!0})})]}),(0,l.jsx)(Q.ZP,{onClick:ue,children:"Print Result"})]})},X=W,$=JSON.parse('{"w":"<?xml version=\\"1.0\\" encoding=\\"UTF-8\\"?>\\n<definitions xmlns=\\"https://www.omg.org/spec/DMN/20191111/MODEL/\\" xmlns:dmndi=\\"https://www.omg.org/spec/DMN/20191111/DMNDI/\\" id=\\"definitions_1y4gzr7\\" name=\\"definitions\\" namespace=\\"http://camunda.org/schema/1.0/dmn\\" exporter=\\"Camunda Modeler\\" exporterVersion=\\"5.19.0\\">\\n  <dmndi:DMNDI>\\n    <dmndi:DMNDiagram id=\\"DMNDiagram_17965dh\\" />\\n  </dmndi:DMNDI>\\n</definitions>\\n"}'),se=["https://unpkg.com/dmn-js@16.3.0/dist/assets/diagram-js.css","https://unpkg.com/dmn-js@16.3.0/dist/assets/dmn-js-shared.css","https://unpkg.com/dmn-js@16.3.0/dist/assets/dmn-js-drd.css","https://unpkg.com/dmn-js@16.3.0/dist/assets/dmn-js-decision-table.css","https://unpkg.com/dmn-js@16.3.0/dist/assets/dmn-js-decision-table-controls.css","https://unpkg.com/dmn-js@16.3.0/dist/assets/dmn-js-literal-expression.css","https://unpkg.com/dmn-js@16.3.0/dist/assets/dmn-font/css/dmn.css"],V=function(){var c=(0,m.useState)(""),o=R()(c,2),h=o[0],g=o[1],E=(0,m.useState)(),y=R()(E,2),M=y[0],T=y[1],A=(0,m.useState)(""),H=R()(A,2),K=H[0],J=H[1];(0,m.useEffect)(function(){J($.w)},[]);var ie=function(){var b=S()(N()().mark(function v(){var u;return N()().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return d.prev=0,d.next=3,M.saveXML({format:!0});case 3:u=d.sent,g(u.xml),console.log("DIAGRAM",u.xml),d.next=11;break;case 8:d.prev=8,d.t0=d.catch(0),console.error("could not save DMN 1.3 diagram",d.t0);case 11:case"end":return d.stop()}},v,null,[[0,8]])}));return function(){return b.apply(this,arguments)}}(),Y=function(){var b=S()(N()().mark(function v(u){var j,d,C,D;return N()().wrap(function(w){for(;;)switch(w.prev=w.next){case 0:return w.prev=0,w.next=3,M.importXML(u);case 3:j=w.sent,d=j.warnings,d.length?console.log("import with warnings",d):console.log("import successful"),C=M.getActiveViewer(),D=C.get("canvas"),D.zoom("fit-viewport"),w.next=14;break;case 11:w.prev=11,w.t0=w.catch(0),console.error("could not import DMN 1.3 diagram",w.t0);case 14:case"end":return w.stop()}},v,null,[[0,11]])}));return function(u){return b.apply(this,arguments)}}(),oe=function(v){var u=document.createElement("link");u.rel="stylesheet",u.href=v,document.head.appendChild(u)};(0,m.useEffect)(function(){se.forEach(function(b){return oe(b)}),T(new(te())({container:document.getElementById("editor-container"),height:500,width:"100%",keyboard:{bindTo:window}}))},[]),(0,m.useEffect)(function(){Y(K)},[M,K]);var ue=function(v){var u=new FileReader;u.readAsText(v),u.onload=function(){u.result&&J(u.result)}};return(0,l.jsxs)("div",{children:[(0,l.jsx)("div",{className:"test-container",children:(0,l.jsxs)("div",{className:"editor-parent",children:[(0,l.jsx)("div",{className:"editor-container",id:"editor-container"}),(0,l.jsx)("div",{className:"editor-tabs"})]})}),(0,l.jsx)(Q.ZP,{id:"save-button",onClick:ie,children:"Test the DMN"}),(0,l.jsx)(z.Z,{maxCount:1,beforeUpload:ue,children:(0,l.jsx)(Q.ZP,{icon:(0,l.jsx)(re.Z,{}),children:"Click to Upload DMN"})}),h&&(0,l.jsx)("div",{children:(0,l.jsx)(X,{xml:h})})]})},I=V}}]);
